|№ загрози| Назва зв’язку (елемент Interaction з екрану аналізу)|STRIDE-клас загрози|Назва загрози (елемент Title з екрану аналізу)| Опис загрози (елемент Description з екрану аналізу)
|----------|:-------------:|:-------------:|:-------------:|------:|
|0|Request|Elevation of Privileges|An adversary may gain unauthorized access to privileged features on Client device|An adversary may get access to admin interface or privileged services like WiFi, SSH, File shares, FTP etc., on a device|
|1|Request|Elevation of Privileges|An adversary may exploit unused services or features in Kinect|An adversary may use unused features or services on Kinect such as UI, USB port etc. Unused features increase the attack surface and serve as additional entry points for the adversary|
|2|Request|Tampering|An adversary may exploit known vulnerabilities in unpatched devices|An adversary may leverage known vulnerabilities and exploit a device if the firmware of the device is not updated|
|3|Request|Tampering|An adversary may tamper Client device  and extract cryptographic key material from it|An adversary may partially or wholly replace the software running on Kinect, potentially allowing the replaced software to leverage the genuine identity of the device if the key material or the cryptographic facilities holding key materials were available to the illicit program. For example an attacker may leverage extracted key material to intercept and suppress data from the device on the communication path and replace it with false data that is authenticated with the stolen key material|
|4|Request|Tampering|An adversary may execute unknown code on Kinect|An adversary may launch malicious code into Kinect and execute it|
|5|Request|Tampering|An adversary may tamper the OS of a device and launch offline attacks|An adversary may launch offline attacks made by disabling or circumventing the installed operating system, or made by physically separating the storage media from the device in order to attack the data separately.|
|6  |An adversary may gain unauthorized access to privileged features on Kinect                        |Elevation of Privileges|Response|An adversary may get access to admin interface or privileged services like WiFi, SSH, File shares, FTP etc., on a device                                                                                                                                                                                                                                                                                                                                                                                                                             |             |Generated    |Ensure that all admin interfaces are secured with strong credentials. Refer: <a href="https://aka.ms/tmtconfigmgmt#admin-strong">https://aka.ms/tmtconfigmgmt#admin-strong</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
|7  |An adversary may exploit unused services or features in Client device                             |Elevation of Privileges|Response|An adversary may use unused features or services on Client device such as UI, USB port etc. Unused features increase the attack surface and serve as additional entry points for the adversary                                                                                                                                                                                                                                                                                                                                                       |             |Generated    |Ensure that only the minimum services/features are enabled on devices. Refer: <a href="https://aka.ms/tmtconfigmgmt#min-enable">https://aka.ms/tmtconfigmgmt#min-enable</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
|8  |An adversary may exploit known vulnerabilities in unpatched devices                               |Tampering              |Response   |An adversary may leverage known vulnerabilities and exploit a device if the firmware of the device is not updated                                                                                                                                                                                                                                                                                                                                                                                                                                    |             |Generated    |Ensure that the Cloud Gateway implements a process to keep the connected devices firmware up to date. Refer: <a href="https://aka.ms/tmtconfigmgmt#cloud-firmware">https://aka.ms/tmtconfigmgmt#cloud-firmware</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
|9  |An adversary may tamper Kinect  and extract cryptographic key material from it                    |Tampering              |Response|An adversary may partially or wholly replace the software running on Client device, potentially allowing the replaced software to leverage the genuine identity of the device if the key material or the cryptographic facilities holding key materials were available to the illicit program. For example an attacker may leverage extracted key material to intercept and suppress data from the device on the communication path and replace it with false data that is authenticated with the stolen key material.                               |             |Generated    |Store Cryptographic Keys securely on IoT Device. Refer: <a href="https://aka.ms/tmtcrypto#keys-iot">https://aka.ms/tmtcrypto#keys-iot</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
|10 |An adversary may execute unknown code on Client device                                            |Tampering              |Response|An adversary may launch malicious code into Client device and execute it                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |             |Generated    |Ensure that unknown code cannot execute on devices. Refer: <a href="https://aka.ms/tmtconfigmgmt#unknown-exe">https://aka.ms/tmtconfigmgmt#unknown-exe</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
|11 |An adversary may tamper the OS of a device and launch offline attacks                             |Tampering              |Response|An adversary may launch offline attacks made by disabling or circumventing the installed operating system, or made by physically separating the storage media from the device in order to attack the data separately.                                                                                                                                                                                                                                                                                                                                |             |Generated    |Encrypt OS and additional partitions of IoT Device with Bitlocker. Refer: <a href="https://aka.ms/tmtconfigmgmt#partition-iot">https://aka.ms/tmtconfigmgmt#partition-iot</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
|12 |An adversary can leverage the weak scalability of Identity Server's token cache and cause DoS     |Denial of Service      |Request|The default cache that Identity Server uses is an in-memory cache that relies on a static store, available process-wide. While this works for native applications, it does not scale for mid tier and backend applications. This can cause availability issues and result in denial of service either by the influence of an adversary or by the large scale of application's users.                                                                                                                                                                 |             |Generated    |Override the default Identity Server token cache with a scalable alternative. Refer: <a href="https://aka.ms/tmtauthn#override-token">https://aka.ms/tmtauthn#override-token</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
|13 |An adversary may gain unauthorized access to privileged features on Client device                 |Elevation of Privileges|Request|An adversary may get access to admin interface or privileged services like WiFi, SSH, File shares, FTP etc., on a device                                                                                                                                                                                                                                                                                                                                                                                                                             |             |Generated    |Ensure that all admin interfaces are secured with strong credentials. Refer: <a href="https://aka.ms/tmtconfigmgmt#admin-strong">https://aka.ms/tmtconfigmgmt#admin-strong</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
|14 |An adversary may exploit unused services or features in Server                                    |Elevation of Privileges|Request|An adversary may use unused features or services on Server such as UI, USB port etc. Unused features increase the attack surface and serve as additional entry points for the adversary                                                                                                                                                                                                                                                                                                                                                              |             |Generated    |Ensure that only the minimum services/features are enabled on devices. Refer: <a href="https://aka.ms/tmtconfigmgmt#min-enable">https://aka.ms/tmtconfigmgmt#min-enable</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
|15 |An adversary may sniff the data sent from Identity Server                                         |Information Disclosure |Request       |An adversary may sniff the data sent from Identity Server. This can lead to a compromise of the tokens issued by the Identity Server                                                                                                                                                                                                                                                                                                                                                                                                                 |             |Generated    |Ensure that all traffic to Identity Server is over HTTPS connection. Refer: <a href="https://aka.ms/tmtcommsec#identity-https">https://aka.ms/tmtcommsec#identity-https</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
|16 |An adversary can bypass authentication due to non-standard Identity Server authentication schemes |Spoofing               |Request      |An adversary can bypass authentication due to non-standard Identity Server authentication schemes                                                                                                                                                                                                                                                                                                                                                                                                                                                    |             |Generated    |Use standard authentication scenarios supported by Identity Server. Refer: <a href="https://aka.ms/tmtauthn#standard-authn-id">https://aka.ms/tmtauthn#standard-authn-id</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
|17 |An adversary can get access to a user's session due to improper logout from Identity Server       |Spoofing               |Request      |An adversary can get access to a user's session due to improper logout from Identity Server                                                                                                                                                                                                                                                                                                                                                                                                                                                          |             |Generated    |Implement proper logout when using Identity Server. Refer: <a href="https://aka.ms/tmtsmgmt#proper-logout">https://aka.ms/tmtsmgmt#proper-logout</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
|18 |An adversary may issue valid tokens if Identity server's signing keys are compromised             |Spoofing               |Request     |An adversary can abuse poorly managed signing keys of Identity Server. In case of key compromise, an adversary will be able to create valid auth tokens using the stolen keys and gain access to the resources protected by Identity server.                                                                                                                                                                                                                                                                                                         |             |Generated    |Ensure that signing keys are rolled over when using Identity Server. Refer: <a href="https://aka.ms/tmtcrypto#rolled-server">https://aka.ms/tmtcrypto#rolled-server</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
|19 |An adversary may guess the client id and secrets of registered applications and impersonate them  |Spoofing               |Request       |An adversary may guess the client id and secrets of registered applications and impersonate them                                                                                                                                                                                                                                                                                                                                                                                                                                                     |             |Generated    |Ensure that cryptographically strong client id, client secret are used in Identity Server. Refer: <a href="https://aka.ms/tmtcrypto#client-server">https://aka.ms/tmtcrypto#client-server</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
|20 |An adversary may exploit known vulnerabilities in unpatched devices                               |Tampering              |Request       |An adversary may leverage known vulnerabilities and exploit a device if the firmware of the device is not updated                                                                                                                                                                                                                                                                                                                                                                                                                                    |             |Generated    |Ensure that the Cloud Gateway implements a process to keep the connected devices firmware up to date. Refer: <a href="https://aka.ms/tmtconfigmgmt#cloud-firmware">https://aka.ms/tmtconfigmgmt#cloud-firmware</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
|21 |An adversary may tamper Client device  and extract cryptographic key material from it             |Tampering              |Request       |An adversary may partially or wholly replace the software running on Server, potentially allowing the replaced software to leverage the genuine identity of the device if the key material or the cryptographic facilities holding key materials were available to the illicit program. For example an attacker may leverage extracted key material to intercept and suppress data from the device on the communication path and replace it with false data that is authenticated with the stolen key material.                                      |             |Generated    |Store Cryptographic Keys securely on IoT Device. Refer: <a href="https://aka.ms/tmtcrypto#keys-iot">https://aka.ms/tmtcrypto#keys-iot</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
|22 |An adversary may tamper the OS of a device and launch offline attacks                             |Tampering              |Request        |An adversary may launch offline attacks made by disabling or circumventing the installed operating system, or made by physically separating the storage media from the device in order to attack the data separately.                                                                                                                                                                                                                                                                                                                                |             |Generated    |Encrypt OS and additional partitions of IoT Device with Bitlocker. Refer: <a href="https://aka.ms/tmtconfigmgmt#partition-iot">https://aka.ms/tmtconfigmgmt#partition-iot</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
|23 |An adversary may gain unauthorized access to Web API due to poor access control checks            |Elevation of Privileges|Request           |An adversary may gain unauthorized access to Web API due to poor access control checks                                                                                                                                                                                                                                                                                                                                                                                                                                                               |             |Generated    |Implement proper authorization mechanism in ASP.NET Web API. Refer: <a href="https://aka.ms/tmtauthz#authz-aspnet">https://aka.ms/tmtauthz#authz-aspnet</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
|24 |An adversary can gain access to sensitive information from an API through error messages          |Information Disclosure |Request          |An adversary can gain access to sensitive data such as the following, through verbose error messages - Server names - Connection strings - Usernames - Passwords - SQL procedures - Details of dynamic SQL failures - Stack trace and lines of code - Variables stored in memory - Drive and folder locations - Application install points - Host configuration settings - Other internal application details                                                                                                                                        |             |Generated    |Ensure that proper exception handling is done in ASP.NET Web API. Refer: <a href="https://aka.ms/tmtxmgmt#exception">https://aka.ms/tmtxmgmt#exception</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
|25 |An adversary can gain access to sensitive data by sniffing traffic to Web API                     |Information Disclosure |Request           |An adversary can gain access to sensitive data by sniffing traffic to Web API                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |             |Generated    |Force all traffic to Web APIs over HTTPS connection. Refer: <a href="https://aka.ms/tmtcommsec#webapi-https">https://aka.ms/tmtcommsec#webapi-https</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
|26 |An adversary can gain access to sensitive data stored in Web API's config files                   |Information Disclosure |Request             |An adversary can gain access to the config files. and if sensitive data is stored in it, it would be compromised.                                                                                                                                                                                                                                                                                                                                                                                                                                    |             |Generated    |Encrypt sections of Web API's configuration files that contain sensitive data. Refer: <a href="https://aka.ms/tmtconfigmgmt#config-sensitive">https://aka.ms/tmtconfigmgmt#config-sensitive</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
|27 |Attacker can deny a malicious act on an API leading to repudiation issues                         |Repudiation            |Request            |Attacker can deny a malicious act on an API leading to repudiation issues                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |             |Generated    |Ensure that auditing and logging is enforced on Web API. Refer: <a href="https://aka.ms/tmtauditlog#logging-web-api">https://aka.ms/tmtauditlog#logging-web-api</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
|28 |An adversary may spoof Server and gain access to Web API                                          |Spoofing               |Request          |If proper authentication is not in place, an adversary can spoof a source process or external entity and gain unauthorized access to the Web Application                                                                                                                                                                                                                                                                                                                                                                                             |             |Generated    |Ensure that standard authentication techniques are used to secure Web APIs. Refer: <a href="https://aka.ms/tmtauthn#authn-secure-api">https://aka.ms/tmtauthn#authn-secure-api</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
|29 |An adversary may inject malicious inputs into an API and affect downstream processes              |Tampering              |Request           |An adversary may inject malicious inputs into an API and affect downstream processes                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |             |Generated    |Ensure that model validation is done on Web API methods. Refer: <a href="https://aka.ms/tmtinputval#validation-api">https://aka.ms/tmtinputval#validation-api</a>  Implement input validation on all string type parameters accepted by Web API methods. Refer: <a href="https://aka.ms/tmtinputval#string-api">https://aka.ms/tmtinputval#string-api</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
|30 |An adversary can gain access to sensitive data by performing SQL injection through Web API        |Tampering              |Request            |SQL injection is an attack in which malicious code is inserted into strings that are later passed to an instance of SQL Server for parsing and execution. The primary form of SQL injection consists of direct insertion of code into user-input variables that are concatenated with SQL commands and executed. A less direct attack injects malicious code into strings that are destined for storage in a table or as metadata. When the stored strings are subsequently concatenated into a dynamic SQL command, the malicious code is executed. |             |Generated    |Ensure that type-safe parameters are used in Web API for data access. Refer: <a href="https://aka.ms/tmtinputval#typesafe-api">https://aka.ms/tmtinputval#typesafe-api</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
|31 |An adversary can gain unauthorized access to database due to lack of network access protection    |Elevation of Privileges|Request            |If there is no restriction at network or host firewall level, to access the database then anyone can attempt to connect to the database from an unauthorized location                                                                                                                                                                                                                                                                                                                                                                                |             |Generated    |Configure a Windows Firewall for Database Engine Access. Refer: <a href="https://aka.ms/tmtconfigmgmt#firewall-db">https://aka.ms/tmtconfigmgmt#firewall-db</a>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
