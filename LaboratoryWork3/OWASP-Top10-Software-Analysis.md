|Ідентифікатор та назва атаки (вразливості)|Вимога (FR, NFR)|Приклад вразливостей, які може використовувати атака|Приклад запобігання успішної реалізації атаки|
|----|----|----|----|
|A1 – недоліки контролю доступу (Broken Access Control)|FR2 Функція авторизації в застосунку FR3 Вибір фізичної вправи. FR10. Можливі функції для лікарів|Порушення принципу найменших привілеїв або заборони за замовчуванням, де доступ має надаватися лише для певних можливостей, ролей або користувачів, але доступний для всіх Дозвіл на перегляд або редагування чужого облікового запису шляхом надання його унікального ідентифікатора (незахищені прямі посилання на об’єкти) Доступ до API із відсутніми елементами керування доступом для POST, PUT і DELETE|За винятком загальнодоступних ресурсів, заборонити за умовчанням Контроль доступу моделі повинен забезпечувати право власності на запис, а не приймати, що користувач може створювати, читати, оновлювати або видаляти будь-який запис Реєстрація збоїв контролю доступу, сповіщення адміністраторів, якщо це необхідно (наприклад, повторні збої)|
|A2 – невдачі (збої) у криптографії (Cryptographic Failures)|FR2 Функція авторизації в застосунку|Використовуються застарілі хеш-функції, такі як MD5 або SHA1, чи використовуються некриптографічні хеш-функції, коли потрібні криптографічні хеш-функції Чи передаються будь-які дані відкритим текстом? Це стосується таких протоколів, як HTTP, SMTP, FTP, які також використовують оновлення TLS, наприклад STARTTLS.|Уникайте застарілих криптографічних функцій і схем заповнення, таких як MD5, SHA1, PKCS номер 1 v1.5.|
|A5 – неправильна конфігурація безпеки (Security Misconfiguration)||Параметри безпеки на серверах застосунків, фреймворках (наприклад, Struts, Spring, ASP.NET), бібліотеках, базах даних тощо не мають безпечних значень.|Автоматизований процес перевірки ефективності конфігурацій і налаштувань у всіх середовищах.|
|A7 – помилки ідентифікації та аутентифікації (Identification and Authentication Failures)|FR2 Функція авторизації в застосунку|Відсутня або неефективна багатофакторна автентифікація Розкриває ідентифікатор сеансу в URL-адресі Повторне використання ідентифікатора сеансу після успішного входу Ідентифікатори сеансу неправильно роблять недійсними. Сеанси користувача або маркери автентифікації (переважно маркери єдиного входу (SSO)) не анулюються належним чином під час виходу з системи або періоду бездіяльності Дозволяє автоматизовані атаки, як-от перекидання облікових даних, коли зловмисник має список дійсних імен користувачів і паролі|Якщо це можливо, застосуйте багатофакторну автентифікацію, щоб запобігти автоматизованому підкиданню облікових даних, грубій форсації та атакам повторного використання вкрадених облікових даних Не надсилайте та не розгортайте облікові дані за замовчуванням, особливо для користувачів із правами адміністратора. Використовуйте серверний безпечний вбудований менеджер сеансів, який генерує новий випадковий ідентифікатор сеансу з високою ентропією після входу. Ідентифікатор сеансу не має бути в URL-адресі, надійно зберігатися та вважатися недійсним після виходу з системи, простою та абсолютних тайм-аутів|
|A8 – невдачі (збої) у забезпеченні цілісності програмного забезпечення та даних (Software and Data Integrity Failures)|FR3 Вибір фізичної вправи. FR10. Можливі функції для лікарів|Незахищений конвеєр CI/CD може призвести до несанкціонованого доступу, зловмисного коду або компрометації системи Зловмисники потенційно можуть завантажити власні оновлення для розповсюдження та запуску на всіх інсталяціях|Використовуйте цифрові підписи або подібні механізми, щоб переконатися, що програмне забезпечення або дані походять з очікуваного джерела та не були змінені Переконайтеся, що бібліотеки та залежності, такі як npm або Maven, використовують надійні репозиторії. Якщо у вас вищий профіль ризику, подумайте про розміщення перевіреного внутрішнього завідомо справного сховища Переконайтеся, що є процес перевірки коду та змін конфігурації, щоб мінімізувати ймовірність того, що зловмисний код або конфігурація можуть бути введені у ваш конвеєр програмного забезпечення Переконайтеся, що ваш конвеєр CI/CD має належну сегрегацію, конфігурацію та контроль доступу, щоб забезпечити цілісність коду, що проходить через процеси створення та розгортання Переконайтеся, що непідписані або незашифровані серіалізовані дані не надсилаються ненадійним клієнтам без певної форми перевірки цілісності або цифрового підпису для виявлення підробки або повторного відтворення серіалізованих даних|
|A9 – невдачі (збої) реєстрації та моніторингу безпеки (Security Logging and Monitoring Failures)|FR2 Функція авторизації в застосунку|Попередження та помилки не створюють жодних, неадекватних або незрозумілих повідомлень журналу Журнали програм і API не перевіряються на наявність підозрілої активності Журнали зберігаються лише локально| Переконайтеся, що журнали генеруються у форматі, який легко можуть використовувати рішення для керування журналами Переконайтеся, що дані журналу закодовані правильно, щоб запобігти ін’єкціям або атакам на системи реєстрації чи моніторингу Переконайтеся, що транзакції з великою вартістю мають журнал аудиту з контролем цілісності, щоб запобігти втручанню або видаленню, наприклад таблиці бази даних, які лише додаються, тощо|
|A10 – підробка запитів на стороні сервера (Server-Side Request Forgery)|FR3 Вибір фізичної вправи. FR10. Можливі функції для лікарів|Помилки SSRF виникають щоразу, коли веб-програма отримує віддалений ресурс без перевірки наданої користувачем URL-адреси. Це дозволяє зловмиснику змусити програму надіслати створений запит до неочікуваного адресата, навіть якщо він захищений брандмауером, VPN або іншим типом списку контролю доступу до мережі (ACL)|Розділіть функції віддаленого доступу до ресурсів у окремі мережі, щоб зменшити вплив SSRF Очистіть і перевірте всі вхідні дані, надані клієнтом Не надсилайте необроблені відповіді клієнтам Не розгортайте інші служби безпеки на передніх системах (наприклад, OpenID). Контролювати локальний трафік у цих системах (наприклад, localhost) Для інтерфейсів із виділеними та керованими групами користувачів використовуйте мережеве шифрування (наприклад, VPN) у незалежних системах, щоб враховувати дуже високі потреби захисту|
