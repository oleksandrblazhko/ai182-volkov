# Тестування перенаправлення URL-адреси на стороні клієнта
|ID|
|----|
|WSTG-CLNT-04|

## Резюме
У цьому розділі описано, як перевірити переспрямування URL-адреси на стороні клієнта, також відоме як відкрите переспрямування. Це помилка перевірки введення, яка виникає, коли програма приймає керований користувачем вхід, який визначає посилання, яке веде до зовнішньої URL-адреси, яка може бути шкідливою. Цей вид уразливості може бути використаний для здійснення фішингової атаки або перенаправлення жертви на сторінку зараження.
Ця вразливість виникає, коли програма приймає ненадійний вхід, який містить значення URL-адреси, і не очищає його. Це значення URL-адреси може змусити веб-програму переспрямувати користувача на іншу сторінку, наприклад на шкідливу сторінку, контрольовану зловмисником.
Ця вразливість може дозволити зловмиснику успішно запустити фішингову аферу та викрасти облікові дані користувача. Оскільки переспрямування ініціюється справжньою програмою, спроби фішингу можуть виглядати надійніше.
Ось приклад URL-адреси фішингової атаки.<br>
http://www.target.site?#redirect=www.fake-target.site
Жертва, яка відвідує цю URL-адресу, буде автоматично перенаправлена на сайт fake-target.site, де зловмисник може розмістити підроблену сторінку, схожу на запланований сайт, щоб викрасти облікові дані жертви.

Відкрите перенаправлення також може використовуватися для створення URL-адреси, яка обійде перевірки контролю доступу програми та перенаправить зловмисника до привілейованих функцій, до яких він зазвичай не матиме доступу.

## Цілі тесту
Визначте точки впровадження, які обробляють URL-адреси або шляхи.
Оцініть місця, куди система може перенаправити.

## Як тестувати
Коли тестувальники вручну перевіряють цей тип уразливості, вони спочатку визначають, чи є перенаправлення на стороні клієнта, реалізовані в коді на стороні клієнта. Ці перенаправлення можуть бути реалізовані, на прикладі JavaScript, за допомогою об’єкта window.location. Це можна використовувати, щоб спрямувати браузер на іншу сторінку, просто призначивши їй рядок. Це показано в наступному фрагменті:

var redir = location.hash.substring(1);<br>
if (redir) {<br>
    window.location='http://'+decodeURIComponent(redir);<br>
}<br>

У цьому прикладі сценарій не виконує жодної перевірки змінної redir, яка містить введені користувачем дані через рядок запиту. Оскільки кодування не застосовується, цей неперевірений вхід передається в об’єкт windows.location, створюючи вразливість переспрямування URL-адреси.

Це означає, що зловмисник може перенаправити жертву на шкідливий сайт, просто надіславши такий рядок запиту:

http://www.victim.site/?#www.malicious.site
З невеликими змінами наведений вище приклад фрагмента може бути вразливим до впровадження JavaScript.

var redir = location.hash.substring(1); <br>
if (redir) {<br>
    window.location=decodeURIComponent(redir);<br>
}<br>
